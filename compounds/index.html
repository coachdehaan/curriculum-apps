<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Chem-Name Builder</title>
  <style>
    * { box-sizing: border-box; font-family: Arial, sans-serif; }
    body {
      margin: 0;
      padding: 10px;
      display: flex;
      gap: 10px;
      height: 100vh;
    }
    #left, #right {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    h2 {
      margin: 2px 0;
      font-size: 16px;
    }
    .panel {
      border: 1px solid #444;
      padding: 6px;
      border-radius: 4px;
    }
    #periodic-table {
      display: grid;
      grid-template-columns: repeat(18, 1fr);
      grid-auto-rows: 32px;
      gap: 2px;
      font-size: 11px;
    }
    .element {
      border: 1px solid #999;
      border-radius: 3px;
      text-align: center;
      line-height: 1.1;
      padding-top: 2px;
      cursor: pointer;
      user-select: none;
    }
    .element.small { font-size: 9px; }
    .element.metal { background-color: #f4f4ff; }
    .element.nonmetal { background-color: #e9ffe9; }
    .element.metalloid { background-color: #fff7df; }
    .element.inactive {
      border-style: dotted;
      color: #bbb;
      cursor: default;
      background-color: #f9f9f9;
    }
    .element.selected {
      outline: 2px solid #000;
    }
    #builder {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .slots-row {
      display: flex;
      gap: 10px;
    }
    .slot {
      flex: 1;
      border: 1px solid #999;
      padding: 4px;
      border-radius: 3px;
    }
    .slot-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 3px;
      font-size: 12px;
    }
    .slot-body {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
    }
    .slot-symbol {
      font-size: 20px;
      font-weight: bold;
    }
    .controls {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 12px;
    }
    .controls input[type="number"] {
      width: 40px;
    }
    #mode-info {
      font-size: 12px;
    }
    #results-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }
    #results-table td {
      border: 1px solid #ccc;
      padding: 3px 4px;
      vertical-align: top;
    }
    #formula-display {
      font-size: 18px;
      font-weight: bold;
    }
    #name-display {
      font-size: 16px;
      font-weight: bold;
    }
    #explanation {
      font-size: 12px;
      white-space: pre-line;
    }
    .badge {
      display: inline-block;
      padding: 1px 4px;
      border-radius: 3px;
      border: 1px solid #333;
      font-size: 10px;
      margin-left: 4px;
    }
  </style>
</head>
<body>
  <div id="left">
    <div class="panel">
      <h2>Interactive Periodic Table (click to select element)</h2>
      <div id="periodic-table"></div>
    </div>
    <div class="panel">
      <div style="font-size: 12px;">
        <strong>Instructions:</strong>
        <ol style="margin: 4px 0 0 18px; padding-left: 12px; font-size: 12px;">
          <li>Select active slot (Element 1 or Element 2).</li>
          <li>Click an element in the table to place it in that slot.</li>
          <li>For covalent pairs, adjust subscripts as needed.</li>
          <li>The app auto-detects ionic vs covalent naming and shows ΔEN and bond type.</li>
        </ol>
      </div>
    </div>
  </div>

  <div id="right">
    <div class="panel" id="builder">
      <h2>Compound Builder</h2>
      <div class="slots-row">
        <div class="slot" id="slot1">
          <div class="slot-header">
            <span>
              <input type="radio" name="activeSlot" value="1" checked /> Element 1
            </span>
            <button type="button" onclick="clearSlot(1)" style="font-size: 10px;">Clear</button>
          </div>
          <div class="slot-body">
            <div>
              <div class="slot-symbol" id="slot1-symbol">–</div>
              <div id="slot1-name">No element</div>
              <div id="slot1-en"></div>
            </div>
            <div class="controls">
              <span>Subscript:</span>
              <input type="number" id="slot1-count" min="1" max="10" value="1" onchange="updateAll()" />
            </div>
          </div>
        </div>
        <div class="slot" id="slot2">
          <div class="slot-header">
            <span>
              <input type="radio" name="activeSlot" value="2" /> Element 2
            </span>
            <button type="button" onclick="clearSlot(2)" style="font-size: 10px;">Clear</button>
          </div>
          <div class="slot-body">
            <div>
              <div class="slot-symbol" id="slot2-symbol">–</div>
              <div id="slot2-name">No element</div>
              <div id="slot2-en"></div>
            </div>
            <div class="controls">
              <span>Subscript:</span>
              <input type="number" id="slot2-count" min="1" max="10" value="1" onchange="updateAll()" />
            </div>
          </div>
        </div>
      </div>
      <div id="mode-info"></div>
      <button type="button" onclick="swapSlots()" style="margin-top: 4px; font-size: 11px;">Swap elements</button>
    </div>

    <div class="panel">
      <h2>Results</h2>
      <table id="results-table">
        <tr>
          <td style="width: 35%;">Formula</td>
          <td><span id="formula-display">–</span></td>
        </tr>
        <tr>
          <td>Name</td>
          <td><span id="name-display">–</span></td>
        </tr>
        <tr>
          <td>EN & Bond Type</td>
          <td>
            <div id="bond-info"></div>
          </td>
        </tr>
        <tr>
          <td>Explanation</td>
          <td><div id="explanation"></div></td>
        </tr>
      </table>
    </div>
  </div>

  <script>
    // ======== DATA ========
    // Minimal but useful set: first 20 elements plus some optional extras.
    const elements = [
      // row, col, symbol, name, EN, category, isMetal (true/false), commonIonCharge (for ionic naming)
      {Z:1,  row:1, col:1,  symbol:"H",  name:"Hydrogen",  EN:2.20, category:"nonmetal",  isMetal:false, commonIonCharge:1},
      {Z:2,  row:1, col:18, symbol:"He", name:"Helium",    EN:null, category:"nonmetal",  isMetal:false},
      {Z:3,  row:2, col:1,  symbol:"Li", name:"Lithium",   EN:0.98, category:"metal",     isMetal:true,  commonIonCharge:1},
      {Z:4,  row:2, col:2,  symbol:"Be", name:"Beryllium", EN:1.57, category:"metal",     isMetal:true,  commonIonCharge:2},
      {Z:5,  row:2, col:13, symbol:"B",  name:"Boron",     EN:2.04, category:"metalloid", isMetal:false},
      {Z:6,  row:2, col:14, symbol:"C",  name:"Carbon",    EN:2.55, category:"nonmetal",  isMetal:false},
      {Z:7,  row:2, col:15, symbol:"N",  name:"Nitrogen",  EN:3.04, category:"nonmetal",  isMetal:false, commonIonCharge:-3},
      {Z:8,  row:2, col:16, symbol:"O",  name:"Oxygen",    EN:3.44, category:"nonmetal",  isMetal:false, commonIonCharge:-2},
      {Z:9,  row:2, col:17, symbol:"F",  name:"Fluorine",  EN:3.98, category:"nonmetal",  isMetal:false, commonIonCharge:-1},
      {Z:10, row:2, col:18, symbol:"Ne", name:"Neon",      EN:null, category:"nonmetal",  isMetal:false},
      {Z:11, row:3, col:1,  symbol:"Na", name:"Sodium",    EN:0.93, category:"metal",     isMetal:true,  commonIonCharge:1},
      {Z:12, row:3, col:2,  symbol:"Mg", name:"Magnesium", EN:1.31, category:"metal",     isMetal:true,  commonIonCharge:2},
      {Z:13, row:3, col:13, symbol:"Al", name:"Aluminum",  EN:1.61, category:"metal",     isMetal:true,  commonIonCharge:3},
      {Z:14, row:3, col:14, symbol:"Si", name:"Silicon",   EN:1.90, category:"metalloid", isMetal:false},
      {Z:15, row:3, col:15, symbol:"P",  name:"Phosphorus",EN:2.19, category:"nonmetal",  isMetal:false, commonIonCharge:-3},
      {Z:16, row:3, col:16, symbol:"S",  name:"Sulfur",    EN:2.58, category:"nonmetal",  isMetal:false, commonIonCharge:-2},
      {Z:17, row:3, col:17, symbol:"Cl", name:"Chlorine",  EN:3.16, category:"nonmetal",  isMetal:false, commonIonCharge:-1},
      {Z:18, row:3, col:18, symbol:"Ar", name:"Argon",     EN:null, category:"nonmetal",  isMetal:false},
      {Z:19, row:4, col:1,  symbol:"K",  name:"Potassium", EN:0.82, category:"metal",     isMetal:true,  commonIonCharge:1},
      {Z:20, row:4, col:2,  symbol:"Ca", name:"Calcium",   EN:1.00, category:"metal",     isMetal:true,  commonIonCharge:2}
      // You can extend this list later with Fe, Cu, Zn, etc.
    ];

    // ======== BUILD PERIODIC TABLE UI ========
    const tableContainer = document.getElementById("periodic-table");

    function buildPeriodicTable() {
      // Fill grid positions 1–7 rows, 1–18 cols with either element buttons or blanks.
      const maxRows = 7;
      const maxCols = 18;
      const lookup = {};
      elements.forEach(e => {
        lookup[`${e.row}-${e.col}`] = e;
      });

      for (let r = 1; r <= maxRows; r++) {
        for (let c = 1; c <= maxCols; c++) {
          const key = `${r}-${c}`;
          const cell = document.createElement("div");
          cell.style.gridRow = r;
          cell.style.gridColumn = c;

          if (lookup[key]) {
            const el = lookup[key];
            cell.classList.add("element");
            if (el.category === "metal") cell.classList.add("metal");
            else if (el.category === "nonmetal") cell.classList.add("nonmetal");
            else cell.classList.add("metalloid");
            cell.dataset.symbol = el.symbol;
            cell.title = `${el.name} (Z=${el.Z}) EN=${el.EN ?? "n/a"}`;
            cell.innerHTML = `<div>${el.symbol}</div><div style="font-size:9px;">${el.Z}</div>`;
            cell.onclick = () => handleElementClick(el.symbol);
          } else {
            cell.classList.add("element", "inactive", "small");
            cell.innerHTML = "";
          }
          tableContainer.appendChild(cell);
        }
      }
    }

    // ======== STATE ========
    let slot1Element = null;
    let slot2Element = null;

    function getActiveSlot() {
      const radios = document.getElementsByName("activeSlot");
      for (const r of radios) {
        if (r.checked) return parseInt(r.value, 10);
      }
      return 1;
    }

    function handleElementClick(symbol) {
      const el = elements.find(e => e.symbol === symbol);
      if (!el) return;
      const active = getActiveSlot();
      if (active === 1) {
        slot1Element = el;
        document.getElementById("slot1-symbol").textContent = el.symbol;
        document.getElementById("slot1-name").textContent = el.name;
        document.getElementById("slot1-en").textContent = (el.EN != null) ? `EN = ${el.EN.toFixed(2)}` : "EN = n/a";
      } else {
        slot2Element = el;
        document.getElementById("slot2-symbol").textContent = el.symbol;
        document.getElementById("slot2-name").textContent = el.name;
        document.getElementById("slot2-en").textContent = (el.EN != null) ? `EN = ${el.EN.toFixed(2)}` : "EN = n/a";
      }
      clearSelectionHighlight();
      highlightSelected();
      updateAll();
    }

    function clearSlot(slot) {
      if (slot === 1) {
        slot1Element = null;
        document.getElementById("slot1-symbol").textContent = "–";
        document.getElementById("slot1-name").textContent = "No element";
        document.getElementById("slot1-en").textContent = "";
      } else {
        slot2Element = null;
        document.getElementById("slot2-symbol").textContent = "–";
        document.getElementById("slot2-name").textContent = "No element";
        document.getElementById("slot2-en").textContent = "";
      }
      updateAll();
      clearSelectionHighlight();
      highlightSelected();
    }

    function swapSlots() {
      const temp = slot1Element;
      slot1Element = slot2Element;
      slot2Element = temp;

      const c1 = document.getElementById("slot1-count");
      const c2 = document.getElementById("slot2-count");
      const tempCount = c1.value;
      c1.value = c2.value;
      c2.value = tempCount;

      if (slot1Element) {
        document.getElementById("slot1-symbol").textContent = slot1Element.symbol;
        document.getElementById("slot1-name").textContent = slot1Element.name;
        document.getElementById("slot1-en").textContent = (slot1Element.EN != null) ? `EN = ${slot1Element.EN.toFixed(2)}` : "EN = n/a";
      } else {
        document.getElementById("slot1-symbol").textContent = "–";
        document.getElementById("slot1-name").textContent = "No element";
        document.getElementById("slot1-en").textContent = "";
      }

      if (slot2Element) {
        document.getElementById("slot2-symbol").textContent = slot2Element.symbol;
        document.getElementById("slot2-name").textContent = slot2Element.name;
        document.getElementById("slot2-en").textContent = (slot2Element.EN != null) ? `EN = ${slot2Element.EN.toFixed(2)}` : "EN = n/a";
      } else {
        document.getElementById("slot2-symbol").textContent = "–";
        document.getElementById("slot2-name").textContent = "No element";
        document.getElementById("slot2-en").textContent = "";
      }

      clearSelectionHighlight();
      highlightSelected();
      updateAll();
    }

    function clearSelectionHighlight() {
      document.querySelectorAll(".element").forEach(el => el.classList.remove("selected"));
    }

    function highlightSelected() {
      const symbols = [];
      if (slot1Element) symbols.push(slot1Element.symbol);
      if (slot2Element) symbols.push(slot2Element.symbol);
      if (symbols.length === 0) return;
      document.querySelectorAll(".element").forEach(cell => {
        const sym = cell.dataset.symbol;
        if (symbols.includes(sym)) {
          cell.classList.add("selected");
        }
      });
    }

    // ======== NAMING HELPERS ========
    const prefixes = {
      1: "mono",
      2: "di",
      3: "tri",
      4: "tetra",
      5: "penta",
      6: "hexa",
      7: "hepta",
      8: "octa",
      9: "nona",
      10: "deca"
    };

    function anionStem(name) {
      name = name.toLowerCase();
      if (name.endsWith("ine")) return name.slice(0, -3) + "id";   // chlorine -> chlorid
      if (name.endsWith("gen")) return name.slice(0, -3) + "id";  // oxygen -> oxid (then +e)
      if (name.endsWith("ur")) return name + "id";                // sulfur -> sulfurid
      if (name.endsWith("orus")) return name.slice(0, -4) + "phid"; // phosphorus -> phosphid
      if (name.endsWith("on")) return name.slice(0, -2) + "id";   // carbon -> carbid
      return name + "id";
    }

    function ucfirst(str) {
      if (!str) return str;
      return str.charAt(0).toUpperCase() + str.slice(1);
    }

    function gcd(a, b) {
      if (!b) return a;
      return gcd(b, a % b);
    }

    // ======== MAIN UPDATE ========
    function updateAll() {
      const formulaDisplay = document.getElementById("formula-display");
      const nameDisplay = document.getElementById("name-display");
      const bondInfo = document.getElementById("bond-info");
      const explanation = document.getElementById("explanation");
      const modeInfo = document.getElementById("mode-info");
      const slot1Count = parseInt(document.getElementById("slot1-count").value, 10) || 1;
      const slot2Count = parseInt(document.getElementById("slot2-count").value, 10) || 1;

      if (!slot1Element || !slot2Element) {
        formulaDisplay.textContent = "–";
        nameDisplay.textContent = "–";
        bondInfo.textContent = "";
        explanation.textContent = "Select two elements to begin.";
        modeInfo.textContent = "";
        return;
      }

      const e1 = slot1Element;
      const e2 = slot2Element;

      // EN/Bond type
      let deltaEN = null;
      let bondTypeEN = "unknown (missing EN)";
      if (e1.EN != null && e2.EN != null) {
        deltaEN = Math.abs(e1.EN - e2.EN);
        if (deltaEN > 1.7) bondTypeEN = "Ionic (by ΔEN > 1.7)";
        else if (deltaEN >= 0.4) bondTypeEN = "Polar covalent (0.4 ≤ ΔEN ≤ 1.7)";
        else bondTypeEN = "Non-polar covalent (ΔEN < 0.4)";
      }

      // Decide naming system based on metal vs nonmetal
      const isIonicByType =
        (e1.isMetal && !e2.isMetal) ||
        (e2.isMetal && !e1.isMetal);

      // Mode info + UI behavior
      if (isIonicByType) {
        modeInfo.innerHTML =
          `<span class="badge">Naming mode: Ionic</span> Metal + nonmetal → ionic naming; subscripts determined by ion charges.`;
      } else {
        modeInfo.innerHTML =
          `<span class="badge">Naming mode: Covalent</span> Nonmetal + nonmetal / metalloid → covalent naming; subscripts come from your inputs.`;
      }

      let formula = "";
      let compoundName = "";
      let explanationText = "";

      if (isIonicByType) {
        // Ionic naming: find cation (metal) and anion (nonmetal), get charges, cross.
        let cation = e1.isMetal ? e1 : e2;
        let anion = e1.isMetal ? e2 : e1;

        const cCharge = cation.commonIonCharge ?? 1;
        const aCharge = anion.commonIonCharge ?? -1;
        const a = Math.abs(cCharge);
        const b = Math.abs(aCharge);
        const g = gcd(a, b);
        const nCation = b / g;
        const nAnion = a / g;

        const cSym = cation.symbol;
        const aSym = anion.symbol;

        function sub(n) {
          return n === 1 ? "" : n.toString();
        }

        if (e1 === cation) {
          formula = `${cSym}${sub(nCation)}${aSym}${sub(nAnion)}`;
        } else {
          formula = `${aSym}${sub(nAnion)}${cSym}${sub(nCation)}`;
        }

        // Ionic name
        const cName = cation.name.toLowerCase();
        let cationName = ucfirst(cName); // no roman numerals for v1
        const baseStem = anionStem(anion.name);
        const anionName = baseStem + "e"; // e.g. oxid + e = oxide

        compoundName = `${cationName} ${anionName}`;

        explanationText =
          `Metal + nonmetal → ionic compound.\n` +
          `${cation.name} is treated as a cation (charge ≈ ${cCharge > 0 ? "+" + cCharge : cCharge}).\n` +
          `${anion.name} is treated as an anion (charge ≈ ${aCharge}).\n` +
          `Subscripts are chosen to balance total positive and negative charge: ` +
          `${nCation} × (${cCharge > 0 ? "+" + cCharge : cCharge}) and ` +
          `${nAnion} × (${aCharge}).\n` +
          `Anion name uses the “-ide” ending → ${anionName}.`;
      } else {
        // Covalent naming: subscripts from user.
        const n1 = slot1Count;
        const n2 = slot2Count;

        function sub(n) {
          return n === 1 ? "" : n.toString();
        }

        formula = `${e1.symbol}${sub(n1)}${e2.symbol}${sub(n2)}`;

        // First element: omit "mono-" when n1 = 1.
        let firstName = e1.name.toLowerCase();
        if (n1 > 1 && prefixes[n1]) {
          firstName = prefixes[n1] + " " + firstName;
        }

        // Second element: always use prefix for n2 (including mono-).
        let secondBase = anionStem(e2.name);
        let secondName = secondBase + "e"; // e.g. oxid + e
        if (prefixes[n2]) {
          secondName = prefixes[n2] + " " + secondName;
        }

        compoundName = `${ucfirst(firstName)} ${secondName}`;

        explanationText =
          `Nonmetal + nonmetal / metalloid → covalent compound.\n` +
          `You chose ${n1} atom(s) of ${e1.name} and ${n2} atom(s) of ${e2.name} → formula ${formula}.\n` +
          `Prefixes indicate the number of atoms (mono-, di-, tri-, etc.).\n` +
          `The first element omits “mono-” when there is only one.\n` +
          `The second element uses a prefix and “-ide” ending → ${secondName}.`;
      }

      // Bond info text
      let bondText = "";
      if (deltaEN == null) {
        bondText = "One or both EN values are missing, so ΔEN and bond classification cannot be calculated.";
      } else {
        bondText = `ΔEN = |EN(${e1.symbol}) − EN(${e2.symbol})| = |${e1.EN.toFixed(2)} − ${e2.EN.toFixed(2)}| = ${deltaEN.toFixed(2)}\n` +
                   `Bond type by ΔEN: ${bondTypeEN}.`;
      }

      formulaDisplay.textContent = formula;
      nameDisplay.textContent = compoundName;
      bondInfo.textContent = bondText;
      explanation.textContent = explanationText;
    }

    // ======== INIT ========
    buildPeriodicTable();
    updateAll();
  </script>
</body>
</html>